Для начала о том, что вообще представляет из себя компьютер:


![some](https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Motherboard_diagram_ru.svg/300px-Motherboard_diagram_ru.svg.png)


## Северный мост
* [википедИя](https://en.wikipedia.org/wiki/Northbridge_(computing))
* [неоченьинтформативноенечто](https://citybook.by/stati/severnyy_i_yuzhnyy_most_na_materinskoy_plate/)

*Северный мост* - системный контроллер, являющийся одним из элементов [чипсета](https://ru.wikipedia.org/wiki/%D0%A7%D0%B8%D0%BF%D1%81%D0%B5%D1%82 "Чипсет") материнской (системной) платы и отвечающий за работу центрального процессора (CPU) с ОЗУ (оперативной памятью, RAM), [видеоадаптером](https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D0%B4%D0%B5%D0%BE%D0%BA%D0%B0%D1%80%D1%82%D0%B0 "Видеокарта") и [южным мостом](https://ru.wikipedia.org/wiki/%D0%AE%D0%B6%D0%BD%D1%8B%D0%B9_%D0%BC%D0%BE%D1%81%D1%82_\(%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80\) "Южный мост (компьютер)")
	т.е к нему подключают все то, что должно работать особенно быстро
От параметров северного моста (тип, частота, пропускная способность) зависят параметры подключённых к нему устройств:
- параметры системной шины (например, [Front Side Bus](https://ru.wikipedia.org/wiki/Front_Side_Bus "Front Side Bus") для Intel) и, косвенно, параметры процессора, а соответственно, степень, до которой компьютер может быть «[разогнан](https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D0%B7%D0%B3%D0%BE%D0%BD_%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BE%D0%B2 "Разгон компьютеров")»;
- параметры оперативной памяти, такие как тип ([SDRAM](https://ru.wikipedia.org/wiki/SDRAM "SDRAM"), [DDR](https://ru.wikipedia.org/wiki/DDR_SDRAM "DDR SDRAM") или др.), максимальный объём, канальность и скорость;
- параметры видеоадаптера, в том числе тип шины для подключения внешнего адаптера ([PCI](https://ru.wikipedia.org/wiki/PCI "PCI"), [AGP](https://ru.wikipedia.org/wiki/AGP "AGP"), [PCI Express](https://ru.wikipedia.org/wiki/PCI_Express "PCI Express")).
Во многих случаях по параметрам северного моста также выбирают [шины](https://ru.wikipedia.org/wiki/%D0%A8%D0%B8%D0%BD%D0%B0_\(%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80\) "Шина (компьютер)") (PCI, PCI Express и др.), позволяющие расширить возможности компьютера
Северный мост соединён с центральным процессором с помощью [Front Side Bus](https://ru.wikipedia.org/wiki/Front_Side_Bus "Front Side Bus"). [Южный мост](https://ru.wikipedia.org/wiki/%D0%AE%D0%B6%D0%BD%D1%8B%D0%B9_%D0%BC%D0%BE%D1%81%D1%82_\(%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80\) "Южный мост (компьютер)"), в свою очередь, подключён к северному мосту для обмена информацией с процессором.

## Южный мост
* [википедИя](https://en.wikipedia.org/wiki/Southbridge_(computing))

*Южный мост** — функциональный контроллер, также известен как контроллер-концентратор ввода-вывода.
	Обычно это одна микросхема, которая связывает «медленные» (по сравнению со связкой Центральный процессор-ОЗУ) взаимодействия (например, Low Pin Count), Super I/O или разъёмы шин на материнской плате с ЦПУ через северный мост, который обычно подключён напрямую к центральному процессору компьютера
Функционально южный мост включает в себя:
- контроллеры шин PCI, SMBus, I2C, LPC, Super I/O
- [DMA](https://ru.wikipedia.org/wiki/DMA "DMA") контроллер 
- контроллер прерываний - интегрированный блок CPU или микросхема, которая отвечает за возможность последовательной обработки запросов на прерывание от различных девайсов (обеспечивает механизм информирования ПО, исполняющегося на ЦПУ, о событиях в периферийных устройствах)
- [PATA](https://ru.wikipedia.org/wiki/PATA "PATA") (IDE) и [SATA](https://ru.wikipedia.org/wiki/SATA "SATA") контроллеры - для подключения внешних носителей
- [часы реального времени](https://ru.wikipedia.org/wiki/%D0%A7%D0%B0%D1%81%D1%8B_%D1%80%D0%B5%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B2%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%B8 "Часы реального времени") (Real Time Clock) - электронная схема, предназначенная для учёта хронометрических данных (текущее время, дата, день недели и др.), представляющая собой систему из автономного источника питания и учитывающего устройства.электронная схема, предназначенная для учёта хронометрических данных (текущее время, дата, день недели и др.), представляющая собой систему из автономного источника питания и учитывающего устройства.
- управление питанием (Power management, APM и ACPI)
- энергонезависимую память BIOS 
- звуковой контроллер 

Опционально южный мост также может включать в себя контроллер [Ethernet](https://ru.wikipedia.org/wiki/Ethernet "Ethernet"), [RAID](https://ru.wikipedia.org/wiki/RAID "RAID")-контроллеры, контроллеры [USB](https://ru.wikipedia.org/wiki/USB "USB"), контроллеры [FireWire](https://ru.wikipedia.org/wiki/FireWire "FireWire") и аудиокодек.
Реже южный мост включает в себя поддержку клавиатуры, мыши и последовательных портов, но обычно эти устройства подключаются с помощью другого устройства — [Super I/O](https://ru.wikipedia.org/wiki/Super_I/O "Super I/O") (контроллера ввода-вывода).





## Взаимодействие с переферией
**Перифери́йное устро́йство**— аппаратура, которая позволяет вводить информациюв компьютер или выводить её из него.
Периферийные устройства являются необязательными для работы системы и могут быть отключены от компьютера. Однако большинство компьютеров используются вместе с теми или иными периферийными устройствами
Переферийные устройства делятся на 3 типа:
* устройства ввода - устройства, использующиеся для ввода информации в компьютер: мышь, клавиатура, тачпад, сенсорный экран, микрофон, веб-камера и т.д.
* устройства вывода - устройства, служащие для вывода информации из компьютера: динамики, монитор, принтер и т.д.
* устройства хранения - устройства, служащие для накопления информации, обрабатываемой компьютером: накопители на жестких магнитных лентах, твердотельные накопители, оптические приводы (CD, DVD, Blu-Ray), CD карты памяти, USB-накопители и т.д.
Устройства компьютера разделили на три вида:
- внутренние (процессор, ОЗУ)
- внешние (периферийные)
- межпериферийные.
Внутренние устройства реализуют определённую архитектуру, формируют аппаратную платформу компьютера. Внешние устройства не зависят от архитектуры компьютера, расширяют возможности компьютера

[не путать с MMIO!](https://en.wikipedia.org/wiki/Saltillo_Airport)

[**Memory-mapped Input/Output (MMIO)** и **Port-mapped Input/Output (PMIO)**](https://en.wikipedia.org/wiki/Memory-mapped_I/O_and_port-mapped_I/O) — это два взаимодополняющих метода выполнения ввода-вывода (I/O) между центральным процессором (ЦП) и периферийными устройствами в компьютере (часто опосредуя доступ через чипсет). Альтернативный подход заключается в использовании выделенных процессоров ввода-вывода, обычно называемых [каналами](https://en.wikipedia.org/wiki/Channel_I/O) на мэйнфреймах, которые выполняют свои собственные инструкции.

* **Memory-mapped Input/Output (MMIO)** использует одно и то же адресное пространство для адресации как основной памяти, так и устройств ввода-вывода. Память и регистры устройств ввода-вывода связаны со значениями адресов, поэтому адрес памяти может относиться либо к части физической оперативной памяти (RAM), либо к памяти и регистрам устройства ввода-вывода. Таким образом, инструкции ЦП, используемые для доступа к памяти (например, MOV), также могут использоваться для доступа к устройствам. Каждое устройство ввода-вывода либо отслеживает адресную шину ЦП и реагирует на любой доступ ЦП к адресу, назначенному этому устройству, подключая системную шину к аппаратному регистру нужного устройства, либо использует выделенную шину. Для размещения устройств ввода-вывода некоторые области адресной шины, используемые ЦП, должны быть зарезервированы для ввода-вывода и не должны быть доступны для обычной физической памяти  
	 **Если покороче:**  при получении процессором команды `MOVE`, процессор пытается записать данные по указанному адресу. Но, каждое устройсво прослушивает адресную шину. При этом каждому регистру устройства соответствует какой-то адрес в памяти (обычно это распределение происходит на этапе загрузки ОС где-то в младших адресах). Если адрес совпадает, то устройство подключает системную шину к требуемому регистру и вуаля, получается что мы работаем с памятью и внешними устройствами совершенно идентично!

* **Port-mapped Input/Output (PMIO)** часто использует специальный класс инструкций ЦП, разработанных специально для выполнения ввода-вывода, например, инструкции `in` и `out`, имеющиеся в микропроцессорах на базе архитектуры x86. Различные формы этих двух инструкций могут копировать один, два или четыре байта (`outb`, `outw` и `outl` соответственно) между регистром `EAX` или одним из подразделений этого регистра на ЦП и указанным адресом порта ввода-вывода, который назначен устройству ввода-вывода. Устройства ввода-вывода имеют отдельное адресное пространство от общей памяти, что достигается либо дополнительным выводом «I/O» на физическом интерфейсе ЦП, либо целой шиной, выделенной для ввода-вывода. Поскольку адресное пространство для ввода-вывода изолировано от адресного пространства для основной памяти, это иногда называют изолированным вводом-выводом.  
**Если покороче:** при получени процессором специальной команды на чтение/запись на переферийное устройство, процессор берет байтики из регистра процессора и отправляет на регистр, указанный в операции, этого устройства. Достигается это или отдельными ногами для кажого устройства (и по нему к этому устройству идет заветный байт), или выделением отдельной шины. 

Противопоставляется этим двум видам (вмете их называют PIO (Programmed Input/Output)) несколько более современный подход: DMA


* [очень советую для ознакомления](https://habr.com/ru/articles/37455/)
* [википедИя](https://en.wikipedia.org/wiki/Direct_memory_access) 
* [википедИя](https://en.wikipedia.org/wiki/Input%E2%80%93output_memory_management_unit) 

* [Direct Memory Access](https://en.wikipedia.org/wiki/Direct_memory_access)- режим обмена данными между устройствами компьютера или же между устройством и основной памятью, в котором центральный процессор (ЦП) не участвует. 
	С DMA ЦП сначала инициирует передачу, затем выполняет другие операции во время передачи и, наконец, получает прерывание от контроллера DMA (DMAC) по завершении операции. Эта функция полезна в любое время, когда ЦП не может справиться со скоростью передачи данных или когда ЦП необходимо выполнить работу, ожидая относительно медленной передачи данных ввода-вывода.
	
	Многие аппаратные системы используют DMA, включая контроллеры дисководов, графические карты, сетевые карты и звуковые карты. DMA также используется для внутричиповой передачи данных в некоторых многоядерных процессорах. Компьютеры, имеющие каналы DMA, могут передавать данные на устройства и с них с гораздо меньшими накладными расходами ЦП, чем компьютеры без каналов DMA. Аналогично, схема обработки внутри многоядерного процессора может передавать данные в локальную память и из нее, не занимая процессорного времени, что позволяет вычислениям и передаче данных происходить параллельно.
	
	DMA также может использоваться для копирования «память в память» или перемещения данных в памяти. DMA может разгрузить дорогостоящие операции памяти, такие как большие копии или операции разброса-сбора, от ЦП к выделенному механизму DMA. Примером реализации является технология ускорения ввода-вывода. DMA представляет интерес для сетевых вычислительных архитектур на кристалле и в памяти.

Принцип действия:
	Стандартный DMA, также называемый third-party DMA, использует контроллер DMA. Контроллер DMA может генерировать адреса памяти и инициировать циклы чтения или записи памяти. Он содержит несколько аппаратных регистров, которые могут быть записаны и прочитаны ЦП. К ним относятся регистр адреса памяти, регистр подсчета байтов и один или несколько регистров управления. В зависимости от того, какие функции предоставляет контроллер DMA, эти регистры управления могут определять некоторую комбинацию источника, назначения, направления передачи (чтение с устройства ввода-вывода или запись на устройство ввода-вывода), размера блока передачи и/или количества байтов для передачи за один пакет.

* Есть три режима (потому что системная шина одна, и процессор ее не может использовать вместе с DMA контроллером):
	* Burst mode - предоставляем контроллеру контроль над системной шиной; пока не закончится передача процессор находится в неактивном режиме (Block Transfer Mode)
	* Cycle stealing mode - после передачи каждого блока посылается запрос процессору (Bus Request Signal) на использование шины; процессор может исполнить какие-то инструкции, и только потом предоставить шину обратно (Bus Grant Signal). Может оказаться безальтернативной, когда процессор не может долго быть неактивным
	* Transparent mode (Hidden DMA data transfer mode) - контроллер сам смотрит, когда процессор не использует системную шину, и только тогда транспортирует данные; понятно, что это самый медленный режим, но зато процессор все время крутится  

**Если покороче**: таскать байты по одному - дорого. Но есть DMA! Если нужно записать/получить в/от какого-то устройства(на самом деле точно также может и между ядрами процессора и просто кусками ОЗУ), то процессор передает контроллеру DMA в соответствующие регистры информацию: куда, откуда и сколько писать/читать, и дает команду на старт. Далее контроллер сам начинает передачу (есть нюанс с тем, как заполучить контроль над системной шиной), и только по завершению снова генерирует прерывание.
Еще нельзя не упомянуть **input–output memory management unit** (**IOMMU**)

* **input–output memory management unit** (**IOMMU**) — это блок управления памятью (MMU), соединяющий шину ввода-вывода с возможностью прямого доступа к памяти (DMA-capable) с основной памятью. Как и традиционный MMU, который преобразует виртуальные адреса, видимые процессором, в физические адреса, IOMMU сопоставляет виртуальные адреса, видимые устройством (также называемые адресами устройств или адресами ввода-вывода, отображаемыми в памяти, в этом контексте) с физическими адресами. Некоторые блоки также обеспечивают защиту памяти от неисправных или вредоносных устройств.

- Advantages:
	* Большие области памяти могут быть выделены без необходимости быть смежными в физической памяти — IOMMU отображает смежные виртуальные адреса в базовые фрагментированные физические адреса. 
	* Устройства, которые не поддерживают адреса памяти достаточно длинные для адресации всей физической памяти, все равно могут адресовать всю память через IOMMU, избегая накладных расходов, связанных с копированием буферов в адресуемое пространство памяти периферийного устройства и из него.
	* Память защищена от вредоносных устройств, которые пытаются проводить атаки DMA, и неисправных устройств, которые пытаются выполнять ошибочные передачи памяти, поскольку устройство не может считывать или записывать в память, которая не была явно выделена (отображена) для него
	* Периферийное страничное хранение памяти может поддерживаться IOMMU  
- Disadvantages:
	* Некоторое снижение производительности из-за накладных расходов на трансляцию и управление (например, обходы таблиц страниц).
	* Потребление физической памяти для добавленных таблиц страниц ввода-вывода (трансляции). Это можно смягчить, если таблицы могут быть общими с процессором.
## Прерывания
[хорошая большая статья](https://habr.com/ru/companies/timeweb/articles/780082/)
[викепедИя](https://en.wikipedia.org/wiki/Interrupt)
[викепедИя](https://en.wikipedia.org/wiki/Programmable_interrupt_controller)

***!!!(ниже самое основное, хотите больше - ссылки выше, там реально много и понятно)!!!***

**Прерывания** - одна из базовых концепций вычислительной техники, которая заключается в том, что при наступлении какого-либо события происходит передача управления специальной процедуре, называемой обработчиком прерываний (ISR, Interrupt Service Routine). В отличие от условных и безусловных переходов, прерывание может быть вызвано в любом месте программы, в том числе если выполнение программы приостановлено, и обусловлено обычно внешними по отношению к программе событиями. После выполнения необходимых действий, обработчик прерываний, как правило, возвращает управление прерванной программе

В зависимости от источника возникновения сигнала прерывания делятся на:
- асинхронные, или внешние (аппаратные) — события, которые исходят от внешних аппаратных устройств (например, периферийных устройств) и могут произойти в любой произвольный момент: сигнал от таймера, сетевой карты или дискового накопителя, нажатие клавиш клавиатуры, движение мыши. Факт возникновения в системе такого прерывания трактуется как _запрос на прерывание_ (Interrupt request, IRQ): устройства сообщают, что они требуют внимания со стороны ОС;
- синхронные, или внутренние — события в самом процессоре как результат нарушения каких-то условий при исполнении машинного кода: деление на ноль или переполнение стека, обращение к недопустимым адресам памяти или недопустимый код операции;
- программные (частный случай внутреннего прерывания) — инициируются исполнением специальной инструкции в коде программы. Программные прерывания, как правило, используются для обращения к функциям встроенного программного обеспечения , драйверов и операционной системы.
Согласно терминологии Intel синхронные — исключения, асинхронные — прерывание.
Термин «ловушка» (trap) иногда используется как синоним термина «прерывание» или «внутреннее прерывание». 
![](https://habrastorage.org/r/w1560/webt/bo/z9/rm/boz9rmjn1gv9kmjnbh15lt7gln4.png)

  Устройство, поддерживающее прерывания, имеет выходной контакт, используемый для сигнализации запроса на прерывание. Выводы IRQ подключены к устройству под названием “программируемый контроллер прерываний” (PIC), которое подключено к выводу INTR процессора. PIC обычно имеет набор портов, используемых для обмена информацией с процессором. Когда устройству, подключенному к одной из линий IRQ PIC, требуется внимание процессора, происходит следующий процесс:
- устройство вызывает прерывание на соответствующем выводе IRQn
- PIC преобразует IRQ в векторное число и записывает его в порт, который ЦП может прочитать.
- PIC вызывает прерывание на выводе CPU INTR
- PIC ждет, пока процессор подтвердит прерывание, прежде чем вызвать другое прерывание.
- ЦП подтверждает прерывание и начинает его обработку
Уже упомяналось, что контроллер выставляет в какой-то порт номер (вектор) прерывания. Так вот, этот вектор - номер в таблице прерываний (Таблица дескрипторов прерываний (IDT)), который хранит адрес и смещение, по которому находится код, исполняемый обработчиком прерывания для данного прерывания. При этом иногда может случится так, что обработчику одновременно нужно обработать несколько прерываний (во время обработки одного пришел другой запрос на прерывание). Во многих архитектурах поддерживается понятие преоритет прерывания. Так, обработчик отложит обработку текущего прерывания, только если преоритет текущего прерывания меньше поступившего ([таблица прерываний](https://www.frolov-lib.ru/books/bsp/v02/ch8_2.htm))

